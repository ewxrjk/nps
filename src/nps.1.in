.TH nps 1
.SH NAME
nps \- list processes
.SH SYNOPSIS
.B nps
.RI [ OPTIONS ]
.RI [ MATCHES | PIDS ]
.SH DESCRIPTION
.B nps
writes a snapshot of information about processes running on the system.
.SH OPTIONS
.IP \fB-a
Select processes which have a controlling terminal.
.IP "\fB-A\fR, \fB-e\fR, \fB--all"
Select all processes.
.IP "\fB-C \fINAME\fR, \fB--command \fINAME"
Select processes by name.
.IP
Equivalent to \fBcomm=:\fINAME\fR (see \fBMATCH EXPRESSIONS\fR below).
.IP \fB-d
Select all processes that are not session leaders.
.IP "\fB-f\fR, \fB--full"
Set the "full" output format.
.IP "\fB-l\fR, \fB--long"
Set the "long" output format.
.IP "\fB-g \fILIST\fR"
Select all processes whose sessions are in \fILIST\fR (by name or
number).
.IP "\fB--group \fILIST\fR"
Select all processes whose effective group ID is in \fILIST\fR (by name or
number).
.IP "\fB-G \fILIST\fR, \fB--real-group \fILIST\fR, \fB--Group \fILIST"
Select all processes whose real group ID is in \fILIST\fR (by name or
number).
.IP "\fB-H\fR, \fB--forest"
Hierarchical display.
.IP "\fB-n \fIANYTHING"
Ignored.
.IP "\fB-o \fIFORMAT\fR, \fB-O \fIFORMAT\fR, \fB--format \fIFORMAT"
Set a specific format.
If multiple options are given then they are cumulative.
See \fBFORMATTING\fR below.
.IP "\fB-p \fILIST\fR, \fB--pid \fILIST"
Select all the processes in \fILIST\fR.
.IP "\fB--ppid \fILIST"
Select all the processes in whose parent is in \fILIST\fR.
.IP "\fB-t \fILIST\fR, \fB--tty \fILIST"
Select all the processes whose controlling terminals are in \fILIST\fR.
Terminal names may be abbreviated by ommitting the initial \fB/dev\fR.
.IP "\fB-u \fILIST\fR, \fB--user \fILIST"
Select all the processes whose effective user ID is in \fILIST\fR (by
name or number).
.IP "\fB-U \fILIST\fR, \fB--real-user \fILIST\fR, \fB--User \fILIST"
Select all the processes whose real user ID is in \fILIST\fR (by
name or number).
.IP "\fB--sort \fIORDER"
Set the order in which processes are listed.
See \fBSORTING\fR below.
.IP \fB-w
Don't truncate output.
.IP \fB--help
Display a usage message.
.IP \fB--help-format
Displays help for the \fB-o\fR option.
.IP \fB--help-match
Displays help for match expressions.
.IP \fB--version
Display a version string.
.PP
All \fILIST\fR options consists of elements separated by spaces or
commas.
.PP
Process selection is cumulative, i.e. if multiple process selection
options are given then any process which is selected by at least
one of them is selected.
If no selection options are given then only processes that share an
effective UID and terminal with the current process are selected.
.SH "MATCH EXPRESSIONS"
Following the options may appear one or more match expressions.
These are general-purpose process selection options and come in several
forms.
.PP
As with other process selection options, the effect of match
expressions is cumulative.
.SS "Display Match Expressions"
These match expressions match the value exactly as displayed.
For numeric properties, this isn't usually very useful.
For example, \fBrss=1048576\fR will never match, because it will
always be \fB1M\fR in that case.
.PP
The first is \fIPROPERTY\fB=\fIVALUE\fR and matches only if the named
property exactly matches the given value.
For instance, \fBcomm=kvm\fR can be used to match \fBkvm\fR processes
only.
.PP
The second is \fIPROPERTY\fB~\fIREGEXP\fR and matches if the named
property matches the extended POSIX regexp.
For instance \fBargs~dbus\fR will match \fBdbus-daemon\fR,
\fBdbus-launch\fR, etc.
.SS "Value Match Expressions"
These match expressions match the value as represented internally,
with the following consequences:
.IP \(bu
Numbers are given their exact value, rather than rounding to
kilobytes, megabytes, etc.
For instance, \fBrss==1048576\fR will match processes with an RSS of
exactly one megabyte.
.IP \(bu
TTY paths are not abbreviated.
.IP \(bu
Times are represnted as second counts.
.PP
The possible match expressions are \fIPROPERTY\fB<\fIVALUE\fR,
\fIPROPERTY\fB<=\fIVALUE\fR, \fIPROPERTY\fB>\fIVALUE\fR,
\fIPROPERTY\fB>=\fIVALUE\fR for ordering comparisons,
\fIPROPERTY\fB==\fIVALUE\fR to test for equality and
\fIPROPERTY\fB<>\fIVALUE\fR or \fIPROPERTY\fB!=\fIVALUE\fR to test for
inequality.
.PP
In all cases, numbers are compared as numbers and strings are compared
lexicographically.
Where the \fIVALUE\fR is a number, it may be represented in hex (using
a \fB0x\fR prefix) or octal (using a \fB0\fR prefix) and suffixed with
\fBK\fR, \fBM\fR, \fBG\fR, \fBT\fR or \fBP\fR to represent kilobytes
up to petabytes, or \fBp\fR to represent pages.
(This is possible even when it doesn't make a great deal of sense,
e.g. \fBpid<1K\fR.)
.PP
For example, to list processes with an RSS of at least one megabyte,
you might use:
.PP
.RS
\fBnps -o user,pid,rss,tty,comm 'rss>=1M'
.RE
.SS "Quoting"
Since value match expressions include shell metacharacters, some
shell quoting may be required.
.PP
In order to distinguish between (for instance) \fB==\fR and \fB=\fR
where the first character of the \fIVALUE\fR is an \fB=\fR sign, any
match operator may be followed by a single \fB:\fR.
When the value is a shell variable it is advisable to always include
the colon, for example:
.PP
.RS
\fBnps -o user,pid,rss,tty,comm "comm=:${COMMAND}"
.RE
.SH FORMATTING
The \fB-o\fR, \fB-O\fR and \fB--format\fR options specify a list of
process properties to display, separated by spaces or commas.
The available properties are:
#include formatting.1
.SS Defaults
If no formatting options at all are specified then the default is
equivalent to:
.PP
.RS
\fB-Opid,tty=TTY,time,comm=CMD
.RE
.PP
The \fB-f\fR option is equivalent to:
.PP
.RS
\fB-Ouser=UID,pid,ppid,pcpu=C,stime,tty=TTY,time,comm=CMD
.RE
.PP
The \fB-l\fR option is equivalent to:
.PP
.RS
\fB-Oflags,state,uid,pid,ppid,pcpu=C,pri,nice,addr,vszK=SZ,
wchan,tty=TTY,time,argsbrief=CMD
.RE
.SH SORTING
The \fB--sort\fR option specifies the properties which control the order
in which processes are displayed, separate by spaces or commas.
The available properties are listed above in \fBFORMATTING\fR.
.PP
If more than one property is specified the second and subsequent are
only considered when ordering processes which cannot be distinguished
by the first (and so on).
.PP
Each property name may be prefix with \fB+\fR to specify descending
order (the default) and \fB-\fR to specify ascending order.
.SS Defaults
If no ordering option is specified then processes are listed in the
order chosen by the kernel.
.SH CONFIGURATION
On startup defaults are read from the file \fB$HOME/.npsrc\fR, if it
exists.
Each line has a \fIKEY\fB=\fIVALUE\fR format, with \fBps\fR
recognizing the following keys:
.IP \fBps_format
The default format.
.IP \fBps_f_format
The format to use if \fB-f\fR is specified.
.IP \fBps_l_format
The format to use if \fB-l\fR is specified.
.PP
In this file, unlike in command line arguments, headings may be quoted
(and must be quoted, if they contain a space, comma or quotes).
.SH ENVIRONMENT
.TP
.B COLUMNS
The maximum line length.
If \fBCOLUMNS\fR is not set then window width is used when writing to
a terminal, and no truncation takes place when writing to any other
kind of output.
.SH BUGS
Rate properties such as \fBpcpu\fR is computed over the process's
entire lifetime, which is stretching the definition of "recent".
.PP
The meaning of \fBflags\fR is not very clear.
.SH STANDARDS
Intended to follow SUS v4.
.SH AUTHOR
Richard Kettlewell <rjk@greenend.org.uk>
